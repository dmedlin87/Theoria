# Theoria environment variables (example)
# Copy to .env and adjust for your environment.
# pwsh: Copy-Item .env.example .env -Force

# --- API (FastAPI) ---
# Local development defaults (SQLite + local storage)
database_url=sqlite:///./theo.db
storage_root=./storage
redis_url=redis://localhost:6379/0
# Allow Next.js dev servers to call the API
THEO_CORS_ALLOWED_ORIGINS=http://127.0.0.1:3000,http://localhost:3000

# Ingestion/embedding defaults
embedding_model=BAAI/bge-m3
embedding_dim=1024
max_chunk_tokens=900
doc_max_pages=5000
transcript_max_window=40.0
user_agent=Theoria/1.0

# Optional fixtures path override (auto-detected if ./fixtures exists)
# fixtures_root=./fixtures

# --- API authentication (configure before boot) ---
# THEO_API_KEYS=alpha,beta  # Use API keys in non-local environments
# THEO_AUTH_JWT_SECRET=change-me
# THEO_AUTH_JWT_AUDIENCE=theo
# THEO_AUTH_JWT_ISSUER=https://example.com/auth
# Allow anonymous access for local development (disable in production)
THEO_AUTH_ALLOW_ANONYMOUS=1

# --- Startup overrides (development only) ---
# Identify the current runtime environment. Insecure overrides are only allowed
# when this is set to "development" or "test".
THEORIA_ENVIRONMENT=development
# Permit insecure combinations (anonymous access, missing secrets, Redis-less caching)
# while iterating locally. Remove or set to 0 in production deployments.
THEO_ALLOW_INSECURE_STARTUP=1

# --- Web (Next.js) ---
# Point the UI to the API in local dev
NEXT_PUBLIC_API_BASE_URL=http://127.0.0.1:8000
API_BASE_URL=http://127.0.0.1:8000

# --- Docker Compose ---
# docker compose (in ./infra) reads this same file and overrides the core
# connection settings internally. Leave these defaults in place unless you
# are running the database or broker elsewhere.
# During compose runs the api service sets:
#   database_url=postgresql+psycopg://postgres:postgres@db:5432/theo
#   redis_url=redis://redis:6379/0
#   storage_root=/data/storage
# and the web service sets API urls to http://api:8000.

# --- Feature flags (ML experiments) ---
# Toggle ML reranker and intent tagger (disabled by default for safety)
RERANKER_ENABLED=0
RERANKER_MODEL_PATH=./models/reranker/model.onnx
INTENT_TAGGER_ENABLED=0
INTENT_MODEL_PATH=./models/intent/intent-tagger.onnx

# --- MCP Server ---
# Feature flags and configuration for the Model Context Protocol integration.
MCP_TOOLS_ENABLED=0
# Override when hosting published schemas elsewhere.
MCP_SCHEMA_BASE_URL=https://theoengine.dev/mcp/schemas
# Comma-separated allowlist entries (tool=identifier) gating write operations.
# Example: MCP_WRITE_ALLOWLIST=note_write=research-team,evidence_card_create=apps-sdk
MCP_WRITE_ALLOWLIST=
# Comma-separated rate limits per tool using shorthand like "note_write=5/min".
MCP_WRITE_RATE_LIMITS=
